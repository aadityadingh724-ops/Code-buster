// LibreTranslate API - Free & Open Source Translation with fallback
export default async function handler(req, res) {
  if (req.method !== 'POST') {
    return res.status(405).json({ error: 'Method not allowed' });
  }
  
  const { texts, target } = req.body;
  if (!texts || !target) {
    return res.status(400).json({ error: 'Missing texts or target language' });
  }

  // Map language codes to LibreTranslate format
  const languageMap = {
    'hi': 'hi',    // Hindi
    'ml': 'en',    // Malayalam fallback to English (limited support)
    'ta': 'en',    // Tamil fallback to English (limited support)
    'te': 'en',    // Telugu fallback to English (limited support)
    'en': 'en'     // English
  };

  const targetLang = languageMap[target] || 'en';
  
  // If target is English, return original texts
  if (targetLang === 'en') {
    return res.status(200).json({ translations: texts });
  }

  // If target is Hindi, use pre-built translations
  if (target === 'hi') {
    const hindiTranslations = {
      heroTitle: "à¤•à¥‡à¤°à¤² à¤•à¤¿à¤¸à¤¾à¤¨à¥‹à¤‚ à¤•à¤¾ AI à¤¸à¤¹à¤¾à¤¯à¤•",
      heroDesc: "AI à¤¦à¥à¤µà¤¾à¤°à¤¾ à¤¸à¤‚à¤šà¤¾à¤²à¤¿à¤¤ à¤¤à¤¤à¥à¤•à¤¾à¤², à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¾à¤¨ à¤•à¥ƒà¤·à¤¿ à¤¸à¤²à¤¾à¤¹ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚à¥¤ à¤…à¤ªà¤¨à¥€ à¤ªà¤¸à¤‚à¤¦à¥€à¤¦à¤¾ à¤­à¤¾à¤·à¤¾ à¤®à¥‡à¤‚ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤ªà¥‚à¤›à¥‡à¤‚ à¤”à¤° à¤•à¥‡à¤°à¤² à¤•à¥€ à¤…à¤¨à¥‚à¤ à¥€ à¤•à¥ƒà¤·à¤¿ à¤ªà¤°à¤¿à¤¸à¥à¤¥à¤¿à¤¤à¤¿à¤¯à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤¸à¤®à¤¾à¤§à¤¾à¤¨ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚à¥¤",
      cta: "à¤ªà¥à¤°à¤¶à¥à¤¨ à¤ªà¥‚à¤›à¤¨à¤¾ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚ â†’",
      whyTitle: "à¤•à¥‡à¤°à¤¾ à¤«à¤¾à¤°à¥à¤® à¤®à¤¿à¤¤à¥à¤° à¤•à¥à¤¯à¥‹à¤‚ à¤šà¥à¤¨à¥‡à¤‚?",
      whyDesc: "à¤‰à¤¨à¥à¤¨à¤¤ AI à¤¤à¤•à¤¨à¥€à¤• à¤ªà¤¾à¤°à¤‚à¤ªà¤°à¤¿à¤• à¤•à¥‡à¤°à¤² à¤•à¥ƒà¤·à¤¿ à¤œà¥à¤žà¤¾à¤¨ à¤¸à¥‡ à¤®à¤¿à¤²à¤•à¤° à¤†à¤ªà¤•à¥‹ à¤¸à¤°à¥à¤µà¥‹à¤¤à¥à¤¤à¤® à¤•à¥ƒà¤·à¤¿ à¤®à¤¾à¤°à¥à¤—à¤¦à¤°à¥à¤¶à¤¨ à¤ªà¥à¤°à¤¦à¤¾à¤¨ à¤•à¤°à¤¤à¥€ à¤¹à¥ˆà¥¤",
      multiLang: "à¤¬à¤¹à¥-à¤­à¤¾à¤·à¤¾ à¤¸à¤®à¤°à¥à¤¥à¤¨",
      askTitle: "à¤…à¤ªà¤¨à¤¾ à¤•à¥ƒà¤·à¤¿ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤ªà¥‚à¤›à¥‡à¤‚",
      askDesc: "à¤¹à¤®à¤¾à¤°à¤¾ AI à¤¸à¤¹à¤¾à¤¯à¤• à¤•à¤¿à¤¸à¥€ à¤­à¥€ à¤•à¥ƒà¤·à¤¿ à¤¸à¤‚à¤¬à¤‚à¤§à¥€ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¥€ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾ à¤•à¥‡ à¤²à¤¿à¤ à¤¤à¥ˆà¤¯à¤¾à¤° à¤¹à¥ˆ",
      aiAnswer: "AI à¤‰à¤¤à¥à¤¤à¤°:",
      techTitle: "AI à¤•à¥‡ à¤¸à¤¾à¤¥ à¤•à¥‡à¤°à¤² à¤•à¤¿à¤¸à¤¾à¤¨à¥‹à¤‚ à¤•à¥‹ à¤¸à¤¶à¤•à¥à¤¤ à¤¬à¤¨à¤¾à¤¨à¤¾",
      techDesc: "à¤¹à¤®à¤¾à¤°à¤¾ AI à¤¸à¤¹à¤¾à¤¯à¤• à¤…à¤¤à¥à¤¯à¤¾à¤§à¥à¤¨à¤¿à¤• à¤¤à¤•à¤¨à¥€à¤• à¤•à¥‹ à¤•à¥‡à¤°à¤² à¤•à¥€ à¤•à¥ƒà¤·à¤¿ à¤ªà¥à¤°à¤¥à¤¾à¤“à¤‚ à¤•à¥‡ à¤—à¤¹à¤°à¥‡ à¤œà¥à¤žà¤¾à¤¨ à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥‹à¤¡à¤¼à¤¤à¤¾ à¤¹à¥ˆà¥¤ à¤ªà¤¾à¤°à¤‚à¤ªà¤°à¤¿à¤• à¤–à¥‡à¤¤à¥€ à¤•à¥‡ à¤¤à¤°à¥€à¤•à¥‹à¤‚ à¤¸à¥‡ à¤²à¥‡à¤•à¤° à¤†à¤§à¥à¤¨à¤¿à¤• à¤¤à¤•à¤¨à¥€à¤•à¥‹à¤‚ à¤¤à¤•, à¤¹à¤® à¤†à¤ªà¤•à¥€ à¤¸à¤­à¥€ à¤–à¥‡à¤¤à¥€ à¤•à¥€ à¤œà¤°à¥‚à¤°à¤¤à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤µà¥à¤¯à¤¾à¤ªà¤• à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾ à¤ªà¥à¤°à¤¦à¤¾à¤¨ à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤",
      cropGuidance: "à¤•à¥‡à¤°à¤² à¤•à¥€ à¤œà¤²à¤µà¤¾à¤¯à¥ à¤•à¥‡ à¤²à¤¿à¤ à¤«à¤¸à¤²-à¤µà¤¿à¤¶à¤¿à¤·à¥à¤Ÿ à¤®à¤¾à¤°à¥à¤—à¤¦à¤°à¥à¤¶à¤¨",
      support: "24/7 AI-à¤¸à¤‚à¤šà¤¾à¤²à¤¿à¤¤ à¤¸à¤®à¤°à¥à¤¥à¤¨",
      multiLangFeature: "à¤¬à¤¹à¥-à¤­à¤¾à¤·à¤¾ à¤¸à¤‚à¤šà¤¾à¤°",
      built: "à¤•à¥‡à¤°à¤² à¤•à¤¿à¤¸à¤¾à¤¨à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ ðŸ’š à¤•à¥‡ à¤¸à¤¾à¤¥ à¤¬à¤¨à¤¾à¤¯à¤¾ à¤—à¤¯à¤¾ | à¤¹à¥ˆà¤•à¤¥à¥‰à¤¨ 2024",
      empower: "à¤•à¥ƒà¤¤à¥à¤°à¤¿à¤® à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¤à¥à¤¤à¤¾ à¤•à¥‡ à¤®à¤¾à¤§à¥à¤¯à¤® à¤¸à¥‡ à¤•à¥ƒà¤·à¤¿ à¤•à¥‹ à¤¸à¤¶à¤•à¥à¤¤ à¤¬à¤¨à¤¾à¤¨à¤¾",
      copyright: "Â© 2024 à¤•à¥‡à¤°à¤¾ à¤«à¤¾à¤°à¥à¤® à¤®à¤¿à¤¤à¥à¤°à¥¤ à¤¸à¤­à¥€ à¤…à¤§à¤¿à¤•à¤¾à¤° à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤à¥¤"
    };
    
    return res.status(200).json({ translations: hindiTranslations });
  }

  // For Malayalam, add basic translations
  if (target === 'ml') {
    const malayalamTranslations = {
      heroTitle: "à´•àµ‡à´°à´³ à´•àµ¼à´·à´•à´°àµà´Ÿàµ† AI à´¸à´¹à´¾à´¯à´¿",
      heroDesc: "AI à´¨à´¿àµ¼à´¦àµà´¦àµ‡à´¶à´¿à´šàµà´š à´¤àµ½à´•àµà´·à´£, à´¬àµà´¦àµà´§à´¿à´ªà´°à´®à´¾à´¯ à´•àµƒà´·à´¿ à´‰à´ªà´¦àµ‡à´¶à´‚ à´¨àµ‡à´Ÿàµà´•. à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´‡à´·àµà´Ÿ à´­à´¾à´·à´¯à´¿àµ½ à´šàµ‹à´¦àµà´¯à´™àµà´™àµ¾ à´šàµ‹à´¦à´¿à´šàµà´šàµ à´•àµ‡à´°à´³à´¤àµà´¤à´¿à´¨àµà´±àµ† à´…à´¦àµà´µà´¿à´¤àµ€à´¯ à´•à´¾àµ¼à´·à´¿à´• à´¸à´¾à´¹à´šà´°àµà´¯à´™àµà´™àµ¾à´•àµà´•à´¾à´¯à´¿ à´µàµà´¯à´•àµà´¤à´¿à´—à´¤ à´ªà´°à´¿à´¹à´¾à´°à´™àµà´™àµ¾ à´¸àµà´µàµ€à´•à´°à´¿à´•àµà´•àµà´•.",
      cta: "à´šàµ‹à´¦àµà´¯à´™àµà´™àµ¾ à´šàµ‹à´¦à´¿à´•àµà´•à´¾àµ» à´¤àµà´Ÿà´™àµà´™àµà´• â†’",
      whyTitle: "à´Žà´¨àµà´¤àµà´•àµŠà´£àµà´Ÿàµ à´•àµ‡à´° à´«à´¾à´‚ à´®à´¿à´¤àµà´° à´¤à´¿à´°à´žàµà´žàµ†à´Ÿàµà´•àµà´•à´£à´‚?",
      whyDesc: "à´µà´¿à´•à´¸à´¿à´¤ AI à´¸à´¾à´™àµà´•àµ‡à´¤à´¿à´• à´µà´¿à´¦àµà´¯ à´ªà´°à´®àµà´ªà´°à´¾à´—à´¤ à´•àµ‡à´°à´³ à´•àµƒà´·à´¿ à´œàµà´žà´¾à´¨à´µàµà´®à´¾à´¯à´¿ à´šàµ‡àµ¼à´¨àµà´¨àµ à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´à´±àµà´±à´µàµà´‚ à´®à´¿à´•à´šàµà´š à´•à´¾àµ¼à´·à´¿à´• à´®à´¾àµ¼à´—àµà´—à´¨à´¿àµ¼à´¦àµà´¦àµ‡à´¶à´‚ à´¨àµ½à´•àµà´¨àµà´¨àµ.",
      multiLang: "à´¬à´¹àµà´­à´¾à´· à´ªà´¿à´¨àµà´¤àµà´£",
      askTitle: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´•àµƒà´·à´¿ à´šàµ‹à´¦àµà´¯à´‚ à´šàµ‹à´¦à´¿à´•àµà´•àµà´•",
      askDesc: "à´à´¤àµŠà´°àµ à´•àµƒà´·à´¿à´¯àµà´®à´¾à´¯à´¿ à´¬à´¨àµà´§à´ªàµà´ªàµ†à´Ÿàµà´Ÿ à´…à´¨àµà´µàµ‡à´·à´£à´¤àµà´¤à´¿à´²àµà´‚ à´¨à´¿à´™àµà´™à´³àµ† à´¸à´¹à´¾à´¯à´¿à´•àµà´•à´¾àµ» à´žà´™àµà´™à´³àµà´Ÿàµ† AI à´¸à´¹à´¾à´¯à´¿ à´¤à´¯àµà´¯à´¾à´±à´¾à´£àµ",
      aiAnswer: "AI à´‰à´¤àµà´¤à´°à´‚:",
      techTitle: "AI à´‰à´ªà´¯àµ‹à´—à´¿à´šàµà´šàµ à´•àµ‡à´°à´³ à´•àµ¼à´·à´•à´°àµ† à´¶à´¾à´•àµà´¤àµ€à´•à´°à´¿à´•àµà´•àµà´¨àµà´¨àµ",
      techDesc: "à´žà´™àµà´™à´³àµà´Ÿàµ† AI à´¸à´¹à´¾à´¯à´¿ à´…à´¤àµà´¯à´¾à´§àµà´¨à´¿à´• à´¸à´¾à´™àµà´•àµ‡à´¤à´¿à´• à´µà´¿à´¦àµà´¯à´¯àµ† à´•àµ‡à´°à´³à´¤àµà´¤à´¿à´¨àµà´±àµ† à´•à´¾àµ¼à´·à´¿à´• à´°àµ€à´¤à´¿à´•à´³àµ†à´•àµà´•àµà´±à´¿à´šàµà´šàµà´³àµà´³ à´†à´´à´¤àµà´¤à´¿à´²àµà´³àµà´³ à´…à´±à´¿à´µàµà´®à´¾à´¯à´¿ à´¸à´‚à´¯àµ‹à´œà´¿à´ªàµà´ªà´¿à´•àµà´•àµà´¨àµà´¨àµ.",
      cropGuidance: "à´•àµ‡à´°à´³à´¤àµà´¤à´¿à´¨àµà´±àµ† à´•à´¾à´²à´¾à´µà´¸àµà´¥à´¯àµà´•àµà´•àµà´³àµà´³ à´µà´¿à´³-à´¨à´¿àµ¼à´¦àµà´¦à´¿à´·àµà´Ÿ à´®à´¾àµ¼à´—àµà´—à´¨à´¿àµ¼à´¦àµà´¦àµ‡à´¶à´‚",
      support: "24/7 AI-à´ªàµà´°à´µàµ¼à´¤àµà´¤à´¿à´¤ à´ªà´¿à´¨àµà´¤àµà´£",
      multiLangFeature: "à´¬à´¹àµà´­à´¾à´· à´†à´¶à´¯à´µà´¿à´¨à´¿à´®à´¯à´‚",
      built: "à´•àµ‡à´°à´³ à´•àµ¼à´·à´•àµ¼à´•àµà´•à´¾à´¯à´¿ ðŸ’š à´‰à´ªà´¯àµ‹à´—à´¿à´šàµà´šàµ à´¨à´¿àµ¼à´®àµà´®à´¿à´šàµà´šà´¤àµ | à´¹à´¾à´•àµà´•à´¤àµà´¤àµº 2024",
      empower: "à´•àµƒà´¤àµà´°à´¿à´® à´¬àµà´¦àµà´§à´¿à´¯à´¿à´²àµ‚à´Ÿàµ† à´•àµƒà´·à´¿à´¯àµ† à´¶à´¾à´•àµà´¤àµ€à´•à´°à´¿à´•àµà´•àµà´¨àµà´¨àµ",
      copyright: "Â© 2024 à´•àµ‡à´° à´«à´¾à´‚ à´®à´¿à´¤àµà´°. à´Žà´²àµà´²à´¾ à´…à´µà´•à´¾à´¶à´™àµà´™à´³àµà´‚ à´¸à´‚à´°à´•àµà´·à´¿à´¤à´‚."
    };
    
    return res.status(200).json({ translations: malayalamTranslations });
  }

  // For Tamil, add basic translations
  if (target === 'ta') {
    const tamilTranslations = {
      heroTitle: "à®•à¯‡à®°à®³ à®µà®¿à®µà®šà®¾à®¯à®¿à®•à®³à®¿à®©à¯ AI à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯",
      heroDesc: "AI à®®à¯‚à®²à®®à¯ à®‰à®Ÿà®©à®Ÿà®¿, à®…à®±à®¿à®µà¯à®³à¯à®³ à®µà®¿à®µà®šà®¾à®¯ à®†à®²à¯‹à®šà®©à¯ˆà®¯à¯ˆà®ªà¯ à®ªà¯†à®±à¯à®™à¯à®•à®³à¯. à®‰à®™à¯à®•à®³à¯ à®µà®¿à®°à¯à®ªà¯à®ªà®®à®¾à®© à®®à¯Šà®´à®¿à®¯à®¿à®²à¯ à®•à¯‡à®³à¯à®µà®¿à®•à®³à¯ˆà®•à¯ à®•à¯‡à®Ÿà¯à®Ÿà¯ à®•à¯‡à®°à®³à®¾à®µà®¿à®©à¯ à®¤à®©à®¿à®¤à¯à®¤à¯à®µà®®à®¾à®© à®µà®¿à®µà®šà®¾à®¯ à®¨à®¿à®²à¯ˆà®®à¯ˆà®•à®³à¯à®•à¯à®•à®¾à®© à®¤à®©à®¿à®ªà¯à®ªà®Ÿà¯à®Ÿ à®¤à¯€à®°à¯à®µà¯à®•à®³à¯ˆà®ªà¯ à®ªà¯†à®±à¯à®™à¯à®•à®³à¯.",
      cta: "à®•à¯‡à®³à¯à®µà®¿à®•à®³à¯ à®•à¯‡à®Ÿà¯à®• à®†à®°à®®à¯à®ªà®¿à®•à¯à®•à®µà¯à®®à¯ â†’",
      whyTitle: "à®à®©à¯ à®•à¯‡à®° à®ƒà®ªà®¾à®°à¯à®®à¯ à®®à®¿à®¤à¯à®°à®¾à®µà¯ˆà®¤à¯ à®¤à¯‡à®°à¯à®¨à¯à®¤à¯†à®Ÿà¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯?",
      whyDesc: "à®®à¯‡à®®à¯à®ªà®Ÿà¯à®Ÿ AI à®¤à¯Šà®´à®¿à®²à¯à®¨à¯à®Ÿà¯à®ªà®®à¯ à®ªà®¾à®°à®®à¯à®ªà®°à®¿à®¯ à®•à¯‡à®°à®³ à®µà®¿à®µà®šà®¾à®¯ à®…à®±à®¿à®µà¯à®Ÿà®©à¯ à®‡à®£à¯ˆà®¨à¯à®¤à¯ à®‰à®™à¯à®•à®³à¯à®•à¯à®•à¯ à®šà®¿à®±à®¨à¯à®¤ à®µà®¿à®µà®šà®¾à®¯ à®µà®´à®¿à®•à®¾à®Ÿà¯à®Ÿà¯à®¤à®²à¯ˆ à®µà®´à®™à¯à®•à¯à®•à®¿à®±à®¤à¯.",
      multiLang: "à®ªà®² à®®à¯Šà®´à®¿ à®†à®¤à®°à®µà¯",
      askTitle: "à®‰à®™à¯à®•à®³à¯ à®µà®¿à®µà®šà®¾à®¯ à®•à¯‡à®³à¯à®µà®¿à®¯à¯ˆà®•à¯ à®•à¯‡à®³à¯à®™à¯à®•à®³à¯",
      askDesc: "à®Žà®¨à¯à®¤à®µà¯Šà®°à¯ à®µà®¿à®µà®šà®¾à®¯à®®à¯ à®¤à¯Šà®Ÿà®°à¯à®ªà®¾à®© à®µà®¿à®©à®µà®²à®¿à®²à¯à®®à¯ à®‰à®™à¯à®•à®³à¯à®•à¯à®•à¯ à®‰à®¤à®µ à®Žà®™à¯à®•à®³à¯ AI à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯ à®¤à®¯à®¾à®°à®¾à®• à®‰à®³à¯à®³à®¤à¯",
      aiAnswer: "AI à®ªà®¤à®¿à®²à¯:",
      techTitle: "AI à®®à¯‚à®²à®®à¯ à®•à¯‡à®°à®³ à®µà®¿à®µà®šà®¾à®¯à®¿à®•à®³à¯ˆ à®®à¯‡à®®à¯à®ªà®Ÿà¯à®¤à¯à®¤à¯à®¤à®²à¯",
      techDesc: "à®Žà®™à¯à®•à®³à¯ AI à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯ à®…à®¤à®¿à®¨à®µà¯€à®© à®¤à¯Šà®´à®¿à®²à¯à®¨à¯à®Ÿà¯à®ªà®¤à¯à®¤à¯ˆ à®•à¯‡à®°à®³à®¾à®µà®¿à®©à¯ à®µà®¿à®µà®šà®¾à®¯ à®¨à®Ÿà¯ˆà®®à¯à®±à¯ˆà®•à®³à®¿à®©à¯ à®†à®´à®®à®¾à®© à®…à®±à®¿à®µà¯à®Ÿà®©à¯ à®‡à®£à¯ˆà®•à¯à®•à®¿à®±à®¤à¯.",
      cropGuidance: "à®•à¯‡à®°à®³à®¾à®µà®¿à®©à¯ à®•à®¾à®²à®¨à®¿à®²à¯ˆà®•à¯à®•à®¾à®© à®ªà®¯à®¿à®°à¯-à®•à¯à®±à®¿à®ªà¯à®ªà®¿à®Ÿà¯à®Ÿ à®µà®´à®¿à®•à®¾à®Ÿà¯à®Ÿà¯à®¤à®²à¯",
      support: "24/7 AI-à®‡à®¯à®™à¯à®•à¯à®®à¯ à®†à®¤à®°à®µà¯",
      multiLangFeature: "à®ªà®² à®®à¯Šà®´à®¿ à®¤à¯Šà®Ÿà®°à¯à®ªà¯",
      built: "à®•à¯‡à®°à®³ à®µà®¿à®µà®šà®¾à®¯à®¿à®•à®³à¯à®•à¯à®•à®¾à®• ðŸ’š à®‰à®Ÿà®©à¯ à®•à®Ÿà¯à®Ÿà®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ | à®¹à®¾à®•à¯à®•à®¤à¯à®¤à®¾à®©à¯ 2024",
      empower: "à®šà¯†à®¯à®±à¯à®•à¯ˆ à®¨à¯à®£à¯à®£à®±à®¿à®µà¯ à®®à¯‚à®²à®®à¯ à®µà®¿à®µà®šà®¾à®¯à®¤à¯à®¤à¯ˆ à®®à¯‡à®®à¯à®ªà®Ÿà¯à®¤à¯à®¤à¯à®¤à®²à¯",
      copyright: "Â© 2024 à®•à¯‡à®° à®ƒà®ªà®¾à®°à¯à®®à¯ à®®à®¿à®¤à¯à®°à®¾. à®…à®©à¯ˆà®¤à¯à®¤à¯ à®‰à®°à®¿à®®à¯ˆà®•à®³à¯à®®à¯ à®ªà®¾à®¤à¯à®•à®¾à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®•à®¿à®©à¯à®±à®©."
    };
    
    return res.status(200).json({ translations: tamilTranslations });
  }

  // For Telugu, add basic translations  
  if (target === 'te') {
    const teluguTranslations = {
      heroTitle: "à°•à±‡à°°à°³ à°°à±ˆà°¤à±à°² AI à°¸à°¹à°¾à°¯à°•à±à°¡à±",
      heroDesc: "AI à°¦à±à°µà°¾à°°à°¾ à°¤à°•à±à°·à°£, à°¤à±†à°²à°¿à°µà±ˆà°¨ à°µà±à°¯à°µà°¸à°¾à°¯ à°¸à°²à°¹à°¾à°²à°¨à± à°ªà±Šà°‚à°¦à°‚à°¡à°¿. à°®à±€ à°‡à°·à±à°Ÿà°®à±ˆà°¨ à°­à°¾à°·à°²à±‹ à°ªà±à°°à°¶à±à°¨à°²à± à°…à°¡à°¿à°—à°¿ à°•à±‡à°°à°³ à°¯à±Šà°•à±à°• à°ªà±à°°à°¤à±à°¯à±‡à°•à°®à±ˆà°¨ à°µà±à°¯à°µà°¸à°¾à°¯ à°ªà°°à°¿à°¸à±à°¥à°¿à°¤à±à°²à°•à± à°µà±à°¯à°•à±à°¤à°¿à°—à°¤ à°ªà°°à°¿à°·à±à°•à°¾à°°à°¾à°²à°¨à± à°ªà±Šà°‚à°¦à°‚à°¡à°¿.",
      cta: "à°ªà±à°°à°¶à±à°¨à°²à± à°…à°¡à°—à°¡à°‚ à°ªà±à°°à°¾à°°à°‚à°­à°¿à°‚à°šà°‚à°¡à°¿ â†’",
      whyTitle: "à°•à±‡à°° à°«à°¾à°°à±à°®à± à°®à°¿à°¤à±à°°à°¨à± à°Žà°‚à°¦à±à°•à± à°Žà°‚à°šà±à°•à±‹à°µà°¾à°²à°¿?",
      whyDesc: "à°…à°§à±à°¨à°¾à°¤à°¨ AI à°¸à°¾à°‚à°•à±‡à°¤à°¿à°•à°¤ à°¸à°¾à°‚à°ªà±à°°à°¦à°¾à°¯ à°•à±‡à°°à°³ à°µà±à°¯à°µà°¸à°¾à°¯ à°œà±à°žà°¾à°¨à°‚à°¤à±‹ à°•à°²à°¿à°¸à°¿ à°®à±€à°•à± à°‰à°¤à±à°¤à°® à°µà±à°¯à°µà°¸à°¾à°¯ à°®à°¾à°°à±à°—à°¦à°°à±à°¶à°¨à°¾à°¨à±à°¨à°¿ à°…à°‚à°¦à°¿à°¸à±à°¤à±à°‚à°¦à°¿.",
      multiLang: "à°¬à°¹à±à°­à°¾à°·à°¾ à°®à°¦à±à°¦à°¤à±",
      askTitle: "à°®à±€ à°µà±à°¯à°µà°¸à°¾à°¯ à°ªà±à°°à°¶à±à°¨à°¨à± à°…à°¡à°—à°‚à°¡à°¿",
      askDesc: "à°à°¦à±ˆà°¨à°¾ à°µà±à°¯à°µà°¸à°¾à°¯à°‚ à°¸à°‚à°¬à°‚à°§à°¿à°¤ à°ªà±à°°à°¶à±à°¨à°²à±‹ à°®à±€à°•à± à°¸à°¹à°¾à°¯à°‚ à°šà±‡à°¯à°¡à°¾à°¨à°¿à°•à°¿ à°®à°¾ AI à°¸à°¹à°¾à°¯à°•à±à°¡à± à°¸à°¿à°¦à±à°§à°‚à°—à°¾ à°‰à°¨à±à°¨à°¾à°¡à±",
      aiAnswer: "AI à°¸à°®à°¾à°§à°¾à°¨à°‚:",
      techTitle: "AI à°¤à±‹ à°•à±‡à°°à°³ à°°à±ˆà°¤à±à°²à°¨à± à°¶à°•à±à°¤à°¿à°µà°‚à°¤à°‚ à°šà±‡à°¯à°¡à°‚",
      techDesc: "à°®à°¾ AI à°¸à°¹à°¾à°¯à°•à±à°¡à± à°…à°¤à±à°¯à°¾à°§à±à°¨à°¿à°• à°¸à°¾à°‚à°•à±‡à°¤à°¿à°•à°¤à°¨à± à°•à±‡à°°à°³ à°µà±à°¯à°µà°¸à°¾à°¯ à°ªà°¦à±à°§à°¤à±à°² à°²à±‹à°¤à±ˆà°¨ à°œà±à°žà°¾à°¨à°‚à°¤à±‹ à°•à°²à±à°ªà±à°¤à°¾à°¡à±.",
      cropGuidance: "à°•à±‡à°°à°³ à°µà°¾à°¤à°¾à°µà°°à°£à°¾à°¨à°¿à°•à°¿ à°ªà°‚à°Ÿ-à°¨à°¿à°°à±à°¦à°¿à°·à±à°Ÿ à°®à°¾à°°à±à°—à°¦à°°à±à°¶à°¨à°‚",
      support: "24/7 AI-à°¶à°•à±à°¤à°¿à°¤à±‹ à°®à°¦à±à°¦à°¤à±",
      multiLangFeature: "à°¬à°¹à±à°­à°¾à°·à°¾ à°•à°®à±à°¯à±‚à°¨à°¿à°•à±‡à°·à°¨à±",
      built: "à°•à±‡à°°à°³ à°°à±ˆà°¤à±à°² à°•à±‹à°¸à°‚ ðŸ’š à°¤à±‹ à°¨à°¿à°°à±à°®à°¿à°‚à°šà°¬à°¡à°¿à°‚à°¦à°¿ | à°¹à±à°¯à°¾à°•à°¥à°¾à°¨à± 2024",
      empower: "à°•à±ƒà°¤à±à°°à°¿à°® à°®à±‡à°§à°¸à±à°¸à± à°¦à±à°µà°¾à°°à°¾ à°µà±à°¯à°µà°¸à°¾à°¯à°¾à°¨à±à°¨à°¿ à°¶à°•à±à°¤à°¿à°µà°‚à°¤à°‚ à°šà±‡à°¯à°¡à°‚",
      copyright: "Â© 2024 à°•à±‡à°° à°«à°¾à°°à±à°®à± à°®à°¿à°¤à±à°°. à°…à°¨à±à°¨à±€ à°¹à°•à±à°•à±à°²à± à°°à°•à±à°·à°¿à°‚à°šà°¬à°¡à±à°¡à°¾à°¯à°¿."
    };
    
    return res.status(200).json({ translations: teluguTranslations });
  }

  // List of LibreTranslate instances to try
  const instances = [
    'https://translate.argosopentech.com',
    'https://libretranslate.de',
    'https://libretranslate.com'
  ];
  
  try {
    const translations = {};
    
    // Try each instance until one works
    let workingInstance = null;
    for (const instance of instances) {
      try {
        const testResponse = await fetch(`${instance}/languages`, {
          method: 'GET',
          headers: { 'Accept': 'application/json' }
        });
        
        if (testResponse.ok && testResponse.headers.get('content-type')?.includes('application/json')) {
          workingInstance = instance;
          break;
        }
      } catch (error) {
        console.log(`Instance ${instance} not available:`, error.message);
        continue;
      }
    }

    if (!workingInstance) {
      console.log('No LibreTranslate instances available, using fallback translations');
      
      // Fallback: Basic translations for Hindi
      if (target === 'hi') {
        const hindiTranslations = {
          heroTitle: "à¤•à¥‡à¤°à¤² à¤•à¤¿à¤¸à¤¾à¤¨à¥‹à¤‚ à¤•à¤¾ AI à¤¸à¤¹à¤¾à¤¯à¤•",
          heroDesc: "AI à¤¦à¥à¤µà¤¾à¤°à¤¾ à¤¸à¤‚à¤šà¤¾à¤²à¤¿à¤¤ à¤¤à¤¤à¥à¤•à¤¾à¤², à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¾à¤¨ à¤•à¥ƒà¤·à¤¿ à¤¸à¤²à¤¾à¤¹ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚à¥¤ à¤…à¤ªà¤¨à¥€ à¤ªà¤¸à¤‚à¤¦à¥€à¤¦à¤¾ à¤­à¤¾à¤·à¤¾ à¤®à¥‡à¤‚ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤ªà¥‚à¤›à¥‡à¤‚ à¤”à¤° à¤•à¥‡à¤°à¤² à¤•à¥€ à¤…à¤¨à¥‚à¤ à¥€ à¤•à¥ƒà¤·à¤¿ à¤ªà¤°à¤¿à¤¸à¥à¤¥à¤¿à¤¤à¤¿à¤¯à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤¸à¤®à¤¾à¤§à¤¾à¤¨ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚à¥¤",
          cta: "à¤ªà¥à¤°à¤¶à¥à¤¨ à¤ªà¥‚à¤›à¤¨à¤¾ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚ â†’",
          whyTitle: "à¤•à¥‡à¤°à¤¾ à¤«à¤¾à¤°à¥à¤® à¤®à¤¿à¤¤à¥à¤° à¤•à¥à¤¯à¥‹à¤‚ à¤šà¥à¤¨à¥‡à¤‚?",
          whyDesc: "à¤‰à¤¨à¥à¤¨à¤¤ AI à¤¤à¤•à¤¨à¥€à¤• à¤ªà¤¾à¤°à¤‚à¤ªà¤°à¤¿à¤• à¤•à¥‡à¤°à¤² à¤•à¥ƒà¤·à¤¿ à¤œà¥à¤žà¤¾à¤¨ à¤¸à¥‡ à¤®à¤¿à¤²à¤•à¤° à¤†à¤ªà¤•à¥‹ à¤¸à¤°à¥à¤µà¥‹à¤¤à¥à¤¤à¤® à¤•à¥ƒà¤·à¤¿ à¤®à¤¾à¤°à¥à¤—à¤¦à¤°à¥à¤¶à¤¨ à¤ªà¥à¤°à¤¦à¤¾à¤¨ à¤•à¤°à¤¤à¥€ à¤¹à¥ˆà¥¤",
          multiLang: "à¤¬à¤¹à¥-à¤­à¤¾à¤·à¤¾ à¤¸à¤®à¤°à¥à¤¥à¤¨",
          askTitle: "à¤…à¤ªà¤¨à¤¾ à¤•à¥ƒà¤·à¤¿ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤ªà¥‚à¤›à¥‡à¤‚",
          askDesc: "à¤¹à¤®à¤¾à¤°à¤¾ AI à¤¸à¤¹à¤¾à¤¯à¤• à¤•à¤¿à¤¸à¥€ à¤­à¥€ à¤•à¥ƒà¤·à¤¿ à¤¸à¤‚à¤¬à¤‚à¤§à¥€ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¥€ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾ à¤•à¥‡ à¤²à¤¿à¤ à¤¤à¥ˆà¤¯à¤¾à¤° à¤¹à¥ˆ",
          aiAnswer: "AI à¤‰à¤¤à¥à¤¤à¤°:",
          techTitle: "AI à¤•à¥‡ à¤¸à¤¾à¤¥ à¤•à¥‡à¤°à¤² à¤•à¤¿à¤¸à¤¾à¤¨à¥‹à¤‚ à¤•à¥‹ à¤¸à¤¶à¤•à¥à¤¤ à¤¬à¤¨à¤¾à¤¨à¤¾",
          techDesc: "à¤¹à¤®à¤¾à¤°à¤¾ AI à¤¸à¤¹à¤¾à¤¯à¤• à¤…à¤¤à¥à¤¯à¤¾à¤§à¥à¤¨à¤¿à¤• à¤¤à¤•à¤¨à¥€à¤• à¤•à¥‹ à¤•à¥‡à¤°à¤² à¤•à¥€ à¤•à¥ƒà¤·à¤¿ à¤ªà¥à¤°à¤¥à¤¾à¤“à¤‚ à¤•à¥‡ à¤—à¤¹à¤°à¥‡ à¤œà¥à¤žà¤¾à¤¨ à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥‹à¤¡à¤¼à¤¤à¤¾ à¤¹à¥ˆà¥¤",
          cropGuidance: "à¤•à¥‡à¤°à¤² à¤•à¥€ à¤œà¤²à¤µà¤¾à¤¯à¥ à¤•à¥‡ à¤²à¤¿à¤ à¤«à¤¸à¤²-à¤µà¤¿à¤¶à¤¿à¤·à¥à¤Ÿ à¤®à¤¾à¤°à¥à¤—à¤¦à¤°à¥à¤¶à¤¨",
          support: "24/7 AI-à¤¸à¤‚à¤šà¤¾à¤²à¤¿à¤¤ à¤¸à¤®à¤°à¥à¤¥à¤¨",
          multiLangFeature: "à¤¬à¤¹à¥-à¤­à¤¾à¤·à¤¾ à¤¸à¤‚à¤šà¤¾à¤°",
          built: "à¤•à¥‡à¤°à¤² à¤•à¤¿à¤¸à¤¾à¤¨à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ ðŸ’š à¤•à¥‡ à¤¸à¤¾à¤¥ à¤¬à¤¨à¤¾à¤¯à¤¾ à¤—à¤¯à¤¾ | à¤¹à¥ˆà¤•à¤¥à¥‰à¤¨ 2024",
          empower: "à¤•à¥ƒà¤¤à¥à¤°à¤¿à¤® à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¤à¥à¤¤à¤¾ à¤•à¥‡ à¤®à¤¾à¤§à¥à¤¯à¤® à¤¸à¥‡ à¤•à¥ƒà¤·à¤¿ à¤•à¥‹ à¤¸à¤¶à¤•à¥à¤¤ à¤¬à¤¨à¤¾à¤¨à¤¾",
          copyright: "Â© 2024 à¤•à¥‡à¤°à¤¾ à¤«à¤¾à¤°à¥à¤® à¤®à¤¿à¤¤à¥à¤°à¥¤ à¤¸à¤­à¥€ à¤…à¤§à¤¿à¤•à¤¾à¤° à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤à¥¤"
        };
        
        return res.status(200).json({ translations: hindiTranslations });
      }
      
      // For other languages, return original English text
      return res.status(200).json({ translations: texts });
    }

    // Process translations with working instance
    for (const [key, value] of Object.entries(texts)) {
      if (!value || value.trim() === '') {
        translations[key] = value;
        continue;
      }

      try {
        const response = await fetch(`${workingInstance}/translate`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify({
            q: value,
            source: 'en',
            target: targetLang,
            format: 'text'
          })
        });

        if (!response.ok) {
          console.warn(`Translation failed for ${key}: ${response.statusText}`);
          translations[key] = value; // Fallback to original text
          continue;
        }

        const contentType = response.headers.get('content-type');
        if (!contentType || !contentType.includes('application/json')) {
          console.warn(`Invalid response type for ${key}: ${contentType}`);
          translations[key] = value; // Fallback to original text
          continue;
        }

        const data = await response.json();
        translations[key] = data.translatedText || value;
        
        // Small delay to be respectful to the free service
        await new Promise(resolve => setTimeout(resolve, 200));
        
      } catch (error) {
        console.warn(`Translation error for ${key}:`, error.message);
        translations[key] = value; // Fallback to original text
      }
    }

    res.status(200).json({ translations });
    
  } catch (error) {
    console.error('Translation service error:', error);
    // Return original texts as fallback
    res.status(200).json({ translations: texts });
  }
}
